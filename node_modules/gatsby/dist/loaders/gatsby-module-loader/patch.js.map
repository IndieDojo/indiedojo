{"version":3,"sources":["../../../src/loaders/gatsby-module-loader/patch.js"],"names":["patch","head","document","querySelector","ensure","__webpack_require__","e","chunks","s","failures","chunkId","callback","loaded","immediate","handler","error","setTimeout","onError","script","lastChild","tagName","console","warn","onload","onerror"],"mappings":";;AAAAA;;AAEA,SAASA,KAAT,GAAiB;AACf,MAAIC,OAAOC,SAASC,aAAT,QAAX;AACA,MAAIC,SAASC,oBAAoBC,CAAjC;AACA,MAAIC,SAASF,oBAAoBG,CAAjC;AACA,MAAIC,QAAJ;;AAEAJ,sBAAoBC,CAApB,GAAwB,UAASI,OAAT,EAAkBC,QAAlB,EAA4B;AAClD,QAAIC,SAAS,KAAb;AACA,QAAIC,YAAY,IAAhB;;AAEA,QAAIC,UAAU,SAAVA,OAAU,CAASC,KAAT,EAAgB;AAC5B,UAAI,CAACJ,QAAL,EAAe;;AAEfA,eAASN,mBAAT,EAA8BU,KAA9B;AACAJ,iBAAW,IAAX;AACD,KALD;;AAOA,QAAI,CAACJ,MAAD,IAAWE,QAAX,IAAuBA,SAASC,OAAT,CAA3B,EAA8C;AAC5CI,cAAQ,IAAR;AACA;AACD;;AAEDV,WAAOM,OAAP,EAAgB,YAAW;AACzB,UAAIE,MAAJ,EAAY;AACZA,eAAS,IAAT;;AAEA,UAAIC,SAAJ,EAAe;AACb;AACA;AACA;AACAG,mBAAW,YAAW;AACpBF;AACD,SAFD;AAGD,OAPD,MAOO;AACLA;AACD;AACF;;AAED;AACA;AAjBA,MAkBA,IAAIF,MAAJ,EAAY;AACV;AACD;;AAEDC,gBAAY,KAAZ;;AAEAI,YAAQ,YAAW;AACjB,UAAIL,MAAJ,EAAY;AACZA,eAAS,IAAT;;AAEA,UAAIL,MAAJ,EAAY;AACVA,eAAOG,OAAP,IAAkB,KAAK,CAAvB;AACD,OAFD,MAEO;AACLD,qBAAaA,WAAW,EAAxB;AACAA,iBAASC,OAAT,IAAoB,IAApB;AACD;;AAEDI,cAAQ,IAAR;AACD,KAZD;AAaD,GArDD;;AAuDA,WAASG,OAAT,CAAiBN,QAAjB,EAA2B;AACzB,QAAIO,SAASjB,KAAKkB,SAAlB;;AAEA,QAAID,OAAOE,OAAP,aAAJ,EAAiC;AAC/B,UAAI,OAAOC,OAAP,oBAAkCA,QAAQC,IAA9C,EAAoD;AAClDD,gBAAQC,IAAR,2BAAuCJ,MAAvC;AACD;;AAED;AACD;;AAEDA,WAAOK,MAAP,GAAgBL,OAAOM,OAAP,GAAiB,YAAW;AAC1CN,aAAOK,MAAP,GAAgBL,OAAOM,OAAP,GAAiB,IAAjC;AACAR,iBAAWL,QAAX,EAAqB,CAArB;AACD,KAHD;AAID;AACF","file":"patch.js","sourcesContent":["patch()\n\nfunction patch() {\n  var head = document.querySelector(`head`)\n  var ensure = __webpack_require__.e\n  var chunks = __webpack_require__.s\n  var failures\n\n  __webpack_require__.e = function(chunkId, callback) {\n    var loaded = false\n    var immediate = true\n\n    var handler = function(error) {\n      if (!callback) return\n\n      callback(__webpack_require__, error)\n      callback = null\n    }\n\n    if (!chunks && failures && failures[chunkId]) {\n      handler(true)\n      return\n    }\n\n    ensure(chunkId, function() {\n      if (loaded) return\n      loaded = true\n\n      if (immediate) {\n        // webpack fires callback immediately if chunk was already loaded\n        // IE also fires callback immediately if script was already\n        // in a cache (AppCache counts too)\n        setTimeout(function() {\n          handler()\n        })\n      } else {\n        handler()\n      }\n    })\n\n    // This is |true| if chunk is already loaded and does not need onError call.\n    // This happens because in such case ensure() is performed in sync way\n    if (loaded) {\n      return\n    }\n\n    immediate = false\n\n    onError(function() {\n      if (loaded) return\n      loaded = true\n\n      if (chunks) {\n        chunks[chunkId] = void 0\n      } else {\n        failures || (failures = {})\n        failures[chunkId] = true\n      }\n\n      handler(true)\n    })\n  }\n\n  function onError(callback) {\n    var script = head.lastChild\n\n    if (script.tagName !== `SCRIPT`) {\n      if (typeof console !== `undefined` && console.warn) {\n        console.warn(`Script is not a script`, script)\n      }\n\n      return\n    }\n\n    script.onload = script.onerror = function() {\n      script.onload = script.onerror = null\n      setTimeout(callback, 0)\n    }\n  }\n}\n"]}