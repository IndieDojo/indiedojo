{"version":3,"sources":["../../../src/loaders/gatsby-module-loader/index.js"],"names":["loaderUtils","require","path","module","exports","pitch","remainingRequest","cacheable","query","parseQuery","chunkName","name","interpolateName","context","regExp","request","stringifyRequest","callback","executor","result","join","__dirname"],"mappings":";;;;;;;;AAAA;;;;;;AAMA,IAAMA,cAAcC,uBAApB;AACA,IAAMC,OAAOD,eAAb;;AAEAE,OAAOC,OAAP,GAAiB,YAAW,CAAE,CAA9B;AACAD,OAAOC,OAAP,CAAeC,KAAf,GAAuB,UAASC,gBAAT,EAA2B;AAChD,OAAKC,SAAL,IAAkB,KAAKA,SAAL,EAAlB;;AAEA,MAAMC,QAAQR,YAAYS,UAAZ,CAAuB,KAAKD,KAA5B,CAAd;AACA,MAAIE,cAAJ;;AAEA,MAAIF,MAAMG,IAAV,EAAgB;AACdD,gBAAYV,YAAYY,eAAZ,CAA4B,IAA5B,EAAkCJ,MAAMG,IAAxC,EAA8C;AACxDE,eAASL,MAAMK,OADyC;AAExDC,cAAQN,MAAMM;AAF0C,KAA9C,CAAZ;AAIAJ,uBAAiB,yBAAeA,SAAf,CAAjB;AACD;;AAED,MAAMK,UAAUf,YAAYgB,gBAAZ,CAA6B,IAA7B,EAAmC,OAAOV,gBAA1C,CAAhB;;AAEA,MAAMW,WAAW,iCAAiCF,OAAjC,QAAjB;;AAEA,MAAMG,4MAMaD,QANb,6BAQCP,SARD,aAAN;;AAWA,MAAMS,oCAEAnB,YAAYgB,gBAAZ,CACA,IADA,QAEId,KAAKkB,IAAL,CAAUC,SAAV,aAFJ,CAFA,sDAO8BH,QAP9B,aAAN;;AAUA,SAAOC,MAAP;AACD,CAxCD","file":"index.js","sourcesContent":["/*\n  Based on Tobias Koppers @sokra bundle-loader\n  https://github.com/webpack/bundle-loader\n\n  and Arthur Stolyar's async-module-loader\n*/\nconst loaderUtils = require(`loader-utils`)\nconst path = require(`path`)\n\nmodule.exports = function() {}\nmodule.exports.pitch = function(remainingRequest) {\n  this.cacheable && this.cacheable()\n\n  const query = loaderUtils.parseQuery(this.query)\n  let chunkName = ``\n\n  if (query.name) {\n    chunkName = loaderUtils.interpolateName(this, query.name, {\n      context: query.context,\n      regExp: query.regExp,\n    })\n    chunkName = `, ${JSON.stringify(chunkName)}`\n  }\n\n  const request = loaderUtils.stringifyRequest(this, `!!` + remainingRequest)\n\n  const callback = `function() { return require(` + request + `) }`\n\n  const executor = `\n     return require.ensure([], function(_, error) {\n        if (error) {\n          console.log('bundle loading error', error)\n          cb(true)\n        } else {\n          cb(null, ${callback})\n        }\n      }${chunkName});\n    `\n\n  const result = `\n    require(\n      ${loaderUtils.stringifyRequest(\n        this,\n        `!${path.join(__dirname, `patch.js`)}`\n      )}\n    );\n    module.exports = function(cb) { ${executor} }\n    `\n\n  return result\n}\n"]}