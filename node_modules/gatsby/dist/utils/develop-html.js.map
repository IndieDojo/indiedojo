{"version":3,"sources":["../../src/utils/develop-html.js"],"names":["debug","require","module","exports","program","directory","compilerConfig","resolve","reject","run","e","stats","hasErrors","toJson","errors","unlinkSync"],"mappings":";;;;;;;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,QAAQC,+BAAd;;AAEAC,OAAOC,OAAP;AAAA,wEAAiB,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACPC,qBADO,GACOD,OADP,CACPC,SADO;;;AAGfL;;AAEA;AAFA,cAHe;AAAA,mBAMc,uBAC3BI,OAD2B,EAE3BC,SAF2B,kBAI3B,IAJ2B,EAK3B,KAL2B,CANd;;AAAA;AAMTC,0BANS;AAAA,6CAcR,uBAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,qCAAQF,eAAeC,OAAf,EAAR,EAAkCE,GAAlC,CAAsC,UAACC,CAAD,EAAIC,KAAJ,EAAc;AAClD,oBAAID,CAAJ,EAAO;AACL,yBAAOF,OAAOE,CAAP,CAAP;AACD;AACD,oBAAIC,MAAMC,SAAN,EAAJ,EAAuB;AACrB,yBAAOJ,mBAAiBG,MAAME,MAAN,GAAeC,MAAhC,EAA0CH,KAA1C,CAAP;AACD;;AAED;AACA,6BAAGI,UAAH,CAAiBV,SAAjB;;AAEA,uBAAOE,QAAQ,IAAR,EAAcI,KAAd,CAAP;AACD,eAZD;AAaD,aAdM,CAdQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjB;;AAAA;AAAA;AAAA;AAAA","file":"develop-html.js","sourcesContent":["/* @flow */\nimport webpack from \"webpack\"\nimport Promise from \"bluebird\"\nimport fs from \"fs\"\nimport webpackConfig from \"./webpack.config\"\n\nconst debug = require(`debug`)(`gatsby:html`)\n\nmodule.exports = async (program: any) => {\n  const { directory } = program\n\n  debug(`generating static HTML`)\n\n  // Static site generation.\n  const compilerConfig = await webpackConfig(\n    program,\n    directory,\n    `develop-html`,\n    null,\n    [`/`]\n  )\n\n  return new Promise((resolve, reject) => {\n    webpack(compilerConfig.resolve()).run((e, stats) => {\n      if (e) {\n        return reject(e)\n      }\n      if (stats.hasErrors()) {\n        return reject(`Error: ${stats.toJson().errors}`, stats)\n      }\n\n      // Remove the temp JS bundle file built for the static-site-generator-plugin\n      fs.unlinkSync(`${directory}/public/render-page.js`)\n\n      return resolve(null, stats)\n    })\n  })\n}\n"]}